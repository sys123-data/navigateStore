<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>

<body>

<script type="text/javascript">

    //Sprint29 - Campaign Redirect Scriptlet

    //This scriptlet will be used in Campaign Mechanism to:

    //1. Open Native MyVodafone Romania App

    //2. Redirect to GooglePlay or AppStore
 
    function getMobileOperatingSystem() {

    const userAgent = navigator.userAgent || navigator.vendor || window.opera;

    if (userAgent.match(/iPad/i) || userAgent.match(/iPhone/i) || userAgent.match(/iPod/i)) {

        return 'iOS';

    } else if (userAgent.match(/HMSCore/i)) {

        return 'HMS';

    } else if (userAgent.match(/Android/i)) {

        return 'Android';
        
    } else {

        return 'unknown';

    }

    }
    var original_start = new Date();
    var lag = 1250;

    
 
    // function isAppInstalled(deeplink) {
    // // You can customize this function based on how you want to check if the app is installed
    //     // For example, you can try to open the app and check for success or failure
    //     // This is just a simple example, and you may need to adjust it based on your app's specifics
    //     try {
    //         window.location.href = "myvodafone://webview?page_id=" + deeplink;
    //         return true;
    //     } catch (error) {
    //         return false;
    //     }
    // }

    var deeplink = location.search.split('page_id=')[1] ? location.search.split('page_id=')[1] : '';
    // var os = getMobileOperatingSystem();
    //alert(deeplink);

    // if (os!='iOS'){
        window.location.href = "myvodafone://webview?page_id=" + deeplink;
    // }
    // else{
    //     if(isAppInstalled(deeplink)){
    //         window.location.href = "myvodafone://webview?page_id=" + deeplink;
    //     }
    // }
    

    // window.addEventListener('pagehide', preventPopup);
 
    setTimeout(function () {

    
    var time_spent_waiting = (new Date() - original_start);
    if (time_spent_waiting > (2.0 * lag)) {
        // We can assume they have the app, so do nothing.
      } else {
        // That was too fast so we can assume they don't have the app.
        var os = getMobileOperatingSystem();
        if (os === "iOS") {

        window.location.href = "itms-apps://apps.apple.com/ro/app/myvodafone-ro/id468772675";
        // window.open(
        // "itms-apps://apps.apple.com/ro/app/myvodafone-ro/id468772675", "_blank");

        //window.location = encodeURIComponent("itms-apps://apps.apple.com/ro/app/myvodafone-ro/id468772675");
        //document.getElementById('ahref').click();

        } else if (os === "HMS"){

        window.location = "market://com.huawei.appmarket.applink?appId=C102056527";

        //document.getElementById('ahref').click();

        } else if (os === "Android"){

        window.location = "market://details?id=ro.vodafone.mcare.android";

        //document.getElementById('ahref').click();

        }
        else
        {
        window.location ="https://www.vodafone.ro/aplicatia-myvodafone/";

        //document.getElementById('ahref').click();
        }
      }
    }, lag);
    
    

</script>
 
<!-- <script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=2&cb=1885201150" async></script></body> -->

</html>